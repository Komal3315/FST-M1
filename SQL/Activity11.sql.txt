SELECT name, number
FROM (
    SELECT salesman_name name, salesman_id number
    FROM salesman
    WHERE salesman_id IN (
        SELECT salesman_id
        FROM orders
        GROUP BY salesman_id
        HAVING COUNT(order_no) > 1
    )
    
    UNION
    
    SELECT customer_name name, customer_id number
    FROM customers
    WHERE customer_id IN (
        SELECT customer_id
        FROM orders
        GROUP BY customer_id
        HAVING COUNT(order_no) > 1
    )
) 
ORDER BY name;


=======================================================
SELECT order_date,
       salesman_id,
       purchase_amount,
       CASE 
           WHEN purchase_amount = max_amt THEN 'highest on'
           WHEN purchase_amount = min_amt THEN 'lowest on'
       END AS status
FROM (
    SELECT o.order_date,
           o.salesman_id,
           o.purchase_amount,
           MAX(o.purchase_amount) OVER (PARTITION BY o.order_date) AS max_amt,
           MIN(o.purchase_amount) OVER (PARTITION BY o.order_date) AS min_amt
    FROM orders o
) 
WHERE purchase_amount = max_amt
   OR purchase_amount = min_amt
ORDER BY order_date, status;
